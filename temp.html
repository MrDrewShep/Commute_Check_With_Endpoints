<!DOCTYPE html>
<html>

<head>
  <title>Simple Map</title>
  <meta name="viewport" content="initial-scale=1.0">
  <meta charset="utf-8">
  <style>
    /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
    #map {
      margin-top: 100px;
      margin-left: 100px;
      height: 500px;
      width: 700px;
    }

    #myform {
      margin-top: 100px;
      margin-left: 100px;
    }

    .controls {
      width: 300px;
    }

    /* Optional: Makes the sample page fill the window. */
    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
  </style>
</head>

<body>
  <div id="map"></div>
  <div class="myform">
    <form action="">
      Start: <input type="text" class="controls" placeholder="Start typing here" id="pac-input-start">
      <br>
      End: <input type="text" class="controls" placeholder="Start typing here" id="pac-input-end">
    </form>
  </div>
  <div id="display">
    <code id="response"></code>
    directions go here
  </div>
  <script>

    var autocomplete;

    function initAutocomplete() {
      // Create the autocomplete object, restricting the search predictions to
      // geographical location types.
      autocomplete_start = new google.maps.places.Autocomplete(
        document.getElementById('pac-input-start'), { types: ['geocode'] });
      autocomplete_end = new google.maps.places.Autocomplete(
        document.getElementById('pac-input-end'), { types: ['geocode'] });

      // Avoid paying for data that you don't need by restricting the set of
      // place fields that are returned to just the address components.
      autocomplete_start.setFields(['address_component']);
      autocomplete_end.setFields(['address_component']);

      // When the user selects an address from the drop-down, populate the
      // address fields in the form.
      // autocomplete.addListener('place_changed', fillInAddress);
    }

    function initMap() {
      var directionsService = new google.maps.DirectionsService();
      var directionsRenderer = new google.maps.DirectionsRenderer({
        draggable: true
      });
      var indy = new google.maps.LatLng(39.768776, -86.157875);
      var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 10,
        center: indy
      });

      directionsRenderer.setMap(map);

      var onChangeHandler = function () {
        calculateAndDisplayRoute(directionsService, directionsRenderer);
      };
      // directionsRenderer.addListener('directions_changed', onDrag);
      document.getElementById('pac-input-start').addEventListener('change', onChangeHandler);
      document.getElementById('pac-input-end').addEventListener('change', onChangeHandler);
    }
    
    
    
    // var onDrag = function () {
    //   var waypoints = directionsRenderer.directions.route[0].legs[0].via_waypoint
    //   console.log(waypoints)
    // };



    function calculateAndDisplayRoute(directionsService, directionsRenderer) {
      directionsService.route(
        {
          origin: { query: document.getElementById('pac-input-start').value },
          destination: { query: document.getElementById('pac-input-end').value },
          travelMode: 'DRIVING'
        },
        function (response, status) {
          if (status === 'OK') {
            document.getElementById('response').textContent = JSON.stringify(response);
            directionsRenderer.setDirections(response);
          } else {
            window.alert('Directions request failed due to ' + status);
          }
        });
    }


    function initialize() {
      initMap();
      initAutocomplete();
    }

  </script>
  <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyATihl_Z2QdHLLLNQiSXzHI6QBzafumoKw&libraries=places&callback=initialize"
    async defer></script>
</body>

</html>